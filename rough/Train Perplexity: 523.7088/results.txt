Test Perplexity Saved to: ./output/test_perplexity/2024701027_ffnn_3-gram_Perplexity_Test_Ulysses-James-Joyce.csv
Training plot saved to ./models/ffnn_3-gram_training_plot_Ulysses-James-Joyce.png
Ulysses-James-Joyce.txt FFNN (3-gram) - Best Params {'embedding_dim': 27, 'hidden_dim': 194, 'learning_rate': 0.0001631147675523071, 'dropout_prob': 0.26197540506371264}
Ulysses-James-Joyce.txt FFNN (3-gram) - Test Perplexity: 1734.3142
Ulysses-James-Joyce.txt FFNN (3-gram) - Train Perplexity: 523.7088


Parameter 80 epochs, 3-ngram

if __name__ == '__main__':
    # --- Data Loading and Preprocessing ---
    parser = argparse.ArgumentParser(description="Train Neural Language Model")
    
    parser.add_argument("--lm_type", type=str, required=True, choices=["ffnn", "rnn", "lstm"], help="Type of language model to train")
    parser.add_argument("--corpus_path", type=str, required=True, help="Path to the corpus")
    
    # Optimized Hyperparameters
    parser.add_argument("--epochs", type=int, default=50, help="Number of epochs")
    parser.add_argument("--embedding_dim", type=int, default=80, help="Embedding dimension (was 100, optimized for generalization)")
    parser.add_argument("--hidden_dim", type=int, default=150, help="Hidden dimension (was 256, optimized to prevent overfitting)")
    parser.add_argument("--batch_size", type=int, default=128, help="Batch Size (was 128, smaller batches for more stable training)")
    parser.add_argument("--seq_len", type=int, default=20, help="Sequence Length for RNN and LSTM")
    parser.add_argument("--n_gram", type=int, default=3, help="N-gram size for FFNN model")
    parser.add_argument("--min_freq", type=int, default=4, help="Minimum frequency for vocab (was 1, filtering rare words helps generalization)")
    parser.add_argument("--lr", type=float, default=0.003, help="Learning rate (adjusted for better convergence)")

    # Regularization and Optimization
    parser.add_argument("--dropout", type=float, default=0.8, help="Dropout probability (increased for better regularization)")
    parser.add_argument("--weight_decay", type=float, default=1e-5, help="L2 regularization (helps prevent overfitting)")
    
    # Model and Output Directories
    parser.add_argument("--model_dir", type=str, default="./models", help="Directory to save models")
    parser.add_argument("--output_dir", type=str, default="./output", help="Directory to save output files")
    parser.add_argument("--student_id", type=str, default="2024701027", help="Your student ID for file naming")

    # Early Stopping
    parser.add_argument("--patience", type=int, default=10, help="Patience for early stopping (prevents overtraining)")